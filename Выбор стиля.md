# Критерии выбора оптимального стиля оформления текста программы

_Грубо говоря, очевидно, что некоторые виды форматирования лучше других._
_Стив Макконелл. "Совершенный код"_

## Вступление
Как правило все мы легко соглашаеся с тем утверждением, что стиль оформления программного кода имеет важное значение для создания качественной программы, облегчает ее понимание, а значит и сопровождение и отладку. Проблема однако в том, как осуществляется выбор конкретных правил такого стиля. На практике, стиль часто определяется по "праву первого", исходя из привычек одного или небольшой группы гуру-программистов, начинающих работать на проектом. При этом сами правила выбираются на основе установившихся привычек этих программистов, либо заимствуются из "авторитетного" источника. В обоих случаях отсутствуют какие-то разумные объяснения того, какие объективные критерии использовались при выборе этих правил. 

Например, какой метод расстановки фигурных скобок предпочтительнее использовать в Си-подобных языках? Большая часть общедоступных стилей для Objective-C и Swift используют "висящие" скобки, когда открывающая скобка находится на той же строке, что и управляющая конструкция или объявление метода/функции, с которыми она связана. Языки Си и Си++ имеют гораздо большую историю и аудиторию пользователей, и как результат число вариантов для них больше [[https://en.wikipedia.org/wiki/Indentation_style]]. 

Однако, кажется очевидным то, что в похожих условиях должны действовать некоторые общие закономерности, которые в той или иной степени определяют "оптимальность" используемого стиля. Однако, мне нигде не удалось найти подобные обоснования.

В Rust Book пишут просто и без затей: "Хорошим стилем является размещение открывающей скобки в строке объявления функции, оставляя пробел между ними" ("It’s good style to place the opening curly bracket on the same line as the function declaration, adding one space in between"). В книге "Язык программирования Си" Б. Керниган и Д. Ритчи пишут:

> Положение скобок не так важно, хотя существуют различные точки зрения на этот счет. Мы остановились на одном из нескольких распространенных стилей их применения. Выберите тот, который больше всего вам нравится, и строго ему следуйте.

Если считать, что разработка программного обеспечения является инженерной деятельностью (по крайней мере, мне хочется надеяться на это) очень странно наблюдать ситуацию, когда решение инженерной задачи, связанное с повышением качества разрабатываемого продукта и уменьшением затрат на его сопровождение, происходит в отсутствии каких-либо сформулированных критериев успешности ее решения. Наверно, можно сказать, что инженерная деятельность на деле подменяется некоторыми религиозными ритуалами. 

В этой статье, не претендую на истину в первой инстанции, я хочу предложить объективные варианты выработки таких критериев. 

## Основная цель задачи формирования стиля программного кода.

_"Programs must be written for people to read, and only incidentally for machines to execute."_
_Harold Abelson, Structure and Interpretation of Computer Programs_

_“Indeed, the ratio of time spent reading versus writing is well over 10 to 1. We are constantly reading old code as part of the effort to write new code. ...[Therefore,] making it easy to read makes it easier to write.”_
_― Robert C. Martin, Clean Code: A Handbook of Agile Software Craftsmanship_

Итак, если мы принимаем ту точку зрения, что программы в первую очередь должны писаться для того, чтобы люди могли их читать, мы должны также и согласиться с тем, что оформление программного кода является задачей такой же степени важности, как и задача разработки алгоритмов и структуры программы. Это то, на что программист должен тратить время и силы. Если не говорить об экстремальных случаях, когда вам приходится быстро править ошибку в программе складского учета под присмотром недовольного пользователя с автоматом Калашникова – незабываемый опыт, который получили некоторые программисты в лихих 90-х.


В чем же состоит основная цель этой задачи? Это задача формирования такого визуального представления и информационного наполнения текста программы, которое бы облегчило (т.е. требовало бы меньше усилий) программисту понимание этой программы и формирование соответствующей ей корректной статической и динамической ментальной модели. Или, если короче, оформление программы должно облегчать ее "чтение". 
<!-- Слово "чтение" я взял в кавычки, потому что это не совсем привычное чтение, о котором мы говорим, когда мы читаем книгу. Текст программы отличается от текста в книге тем, что он гораздо более сильно структурирован, -->
Процесс понимания можно разделить на следующие подзадачи:
- непосредственно чтение текста;
- распознавание синтаксических элементов программы (различение имен переменных, функций, констант, операций над ними);
- понимание логической роли отдельных переменных и функций.
- распознование элементов рекурсивной логической структуры;

Очевидно, что мы хотим, чтобы выбранный нами стиль оформления программного кода оптимизировал (облегчал) выполнение всех этих задач в частности и в общем.

### Чтение

Текст программы сильно структурирован, в отличии от обычного текста. И очень часто, это не простое чтение, которое мы наблюдаем при чтении книг. При распозновании логической структуры, программисты ищут, так называемые маяки – некоторые узнаваемые атрибуты программного кода, такие как специфические переменные, управляющие конструкции, выражения.
Тем не менее, психо-физиологические механизмы, задействованные в процессе чтения, остаются теми же и, к счастью для нас, хорошо изучены.



Несмотря на то, что чтение текста программы отличается от того, как мы читаем текст в книге,  


